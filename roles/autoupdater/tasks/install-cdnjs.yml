---

- name: clone cdnjs's repos
  git:
    repo: "git@github.com:cdnjs/{{ item }}.git"
    dest: "/cdnjs-sven/{{ item }}"
    version: master
  loop:
    - script
    - bot
    - autoupdate
    - new-website
    - buildScript

- name: clone cdnjs repos
  git:
    repo: git@github.com:cdnjs/cdnjs.git
    dest: /cdnjs-sven/cdnjs
    update: no

- name: clone PeterDaveHello/web-minify-helper repo
  git:
    repo: https://github.com/PeterDaveHello/web-minify-helper.git
    dest: /cdnjs-sven/web-minify-helper

- name: install npm deps
  shell: npm install
  args:
    chdir: "/cdnjs-sven/{{ item }}"
  loop:
    - web-minify-helper
    - cdnjs
    - autoupdate

- name: symlink zopflipng-f
  become: true
  file:
    src: /cdnjs-sven/bot/scripts/zopflipng-f
    dest: /usr/bin/zopflipng-f
    state: link
    mode: '0777'
