---

- stat:
    path: ~/google_storage_cdnjs_assets.json
  register: json
- name: store google cloud credential
  copy:
    dest: ~/google_storage_cdnjs_assets.json
    content: "{{ google_storage_cdnjs_assets }}"
  when: not json.stat.exists

- set_fact:
    tools:
      - packages
      - algolia
      - checker
      - autoupdate

- name: download tools
  get_url:
    force: true
    url: "https://github.com/cdnjs/tools/releases/latest/download/{{ item }}"
    dest: "/home/deploy/{{ item }}"
  loop: "{{ tools }}"

- name: make tools executable and owned by deploy
  file:
    owner: deploy
    group: deploy
    path: "/home/deploy/{{ item }}"
    mode: '0777'
  loop: "{{ tools }}"
